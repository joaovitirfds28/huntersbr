<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Hunters BR</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #1a0000 0%, #000000 100%);
            color: #fff;
            padding: 20px;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        h1 {
            color: #ff0000;
            text-align: center;
            margin-bottom: 30px;
            text-shadow: 0 0 20px #ff0000;
        }
        button {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #ff0000 0%, #8b0000 100%);
            color: #fff;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            cursor: pointer;
        }
        button:hover { opacity: 0.9; }
        .message-card {
            background: rgba(139, 0, 0, 0.3);
            border: 2px solid #ff0000;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .message-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #ff0000;
        }
        .status-pending { color: #ffcc00; }
        .status-answered { color: #00ff00; }
        textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #ff0000;
            border-radius: 8px;
            background: rgba(0,0,0,0.5);
            color: #fff;
            margin-top: 10px;
            resize: vertical;
        }
        .btn-small {
            width: auto;
            padding: 8px 20px;
            margin-top: 10px;
            font-size: 0.9em;
        }
        .stats {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }
        .stat-box {
            flex: 1;
            background: rgba(139, 0, 0, 0.3);
            border: 2px solid #ff0000;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }
        .stat-number {
            font-size: 2.5em;
            color: #ff0000;
            font-weight: bold;
        }
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 2px solid #ff0000;
        }
        .tab {
            padding: 15px 30px;
            background: rgba(139, 0, 0, 0.3);
            border: 2px solid #ff0000;
            border-bottom: none;
            border-radius: 10px 10px 0 0;
            cursor: pointer;
            transition: all 0.3s;
        }
        .tab:hover { background: rgba(255, 0, 0, 0.3); }
        .tab.active { background: #ff0000; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        .filter-bar {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .filter-btn {
            padding: 10px 20px;
            background: rgba(139, 0, 0, 0.5);
            border: 2px solid #ff0000;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .filter-btn:hover, .filter-btn.active { background: #ff0000; }
        .recruit-card {
            background: rgba(0, 100, 0, 0.2);
            border: 2px solid #00ff00;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        .login-box {
            max-width: 400px;
            margin: 100px auto;
            background: rgba(139, 0, 0, 0.3);
            border: 2px solid #ff0000;
            border-radius: 15px;
            padding: 30px;
        }
        input {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border: 2px solid #ff0000;
            border-radius: 8px;
            background: rgba(0,0,0,0.5);
            color: #fff;
            font-size: 1em;
        }
        #adminPanel { display: none; }
    </style>
</head>
<body>
    <div id="loginPanel" class="login-box">
        <h1>üîê Admin Login</h1>
        <input type="password" id="adminPass" placeholder="Senha de Admin">
        <button onclick="login()">Entrar</button>
    </div>

    <div id="adminPanel">
    <div class="container">
        <h1>‚öîÔ∏è Painel Admin - Hunters BR</h1>
        
        <div class="stats">
            <div class="stat-box">
                <div class="stat-number" id="totalMsg">0</div>
                <div>Mensagens Suporte</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="pendingMsg">0</div>
                <div>Pendentes</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="totalRecruits">0</div>
                <div>Inscri√ß√µes</div>
            </div>
            <div class="stat-box">
                <div class="stat-number" id="approvedRecruits">0</div>
                <div>Aprovados</div>
            </div>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="switchTab('messages')">Mensagens Suporte</div>
            <div class="tab" onclick="switchTab('recruits')">Inscri√ß√µes</div>
            <div class="tab" onclick="switchTab('settings')">Configura√ß√µes</div>
        </div>

        <div id="messagesTab" class="tab-content active">
            <div class="filter-bar">
                <div class="filter-btn active" onclick="filterMessages('all')">Todas</div>
                <div class="filter-btn" onclick="filterMessages('pending')">Pendentes</div>
                <div class="filter-btn" onclick="filterMessages('answered')">Respondidas</div>
            </div>
            <div id="messagesList"></div>
        </div>

        <div id="recruitsTab" class="tab-content">
            <div class="filter-bar">
                <div class="filter-btn active" onclick="filterRecruits('all')">Todos</div>
                <div class="filter-btn" onclick="filterRecruits('approved')">Aprovados</div>
                <div class="filter-btn" onclick="filterRecruits('rejected')">Rejeitados</div>
            </div>
            <div id="recruitsList"></div>
        </div>

        <div id="settingsTab" class="tab-content">
            <div class="message-card">
                <h2 style="color: #ff0000; margin-bottom: 20px;">‚öôÔ∏è Configura√ß√µes</h2>
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px;">Idade M√°xima Permitida:</label>
                    <input type="number" id="maxAge" value="13" style="width: 200px;">
                </div>
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px;">Level M√≠nimo:</label>
                    <input type="number" id="minLevel" value="2400" style="width: 200px;">
                </div>
                <div style="margin-bottom: 20px;">
                    <label style="display: block; margin-bottom: 10px;">Bounty M√≠nimo (em milh√µes):</label>
                    <input type="number" id="minBounty" value="2.5" step="0.1" style="width: 200px;">
                </div>
                <button onclick="saveSettings()" style="width: auto; padding: 12px 30px;">üíæ Salvar Configura√ß√µes</button>
                <button onclick="exportData()" style="width: auto; padding: 12px 30px; margin-left: 10px; background: #00aa00;">üì• Exportar Dados</button>
                <button onclick="clearAllData()" style="width: auto; padding: 12px 30px; margin-left: 10px; background: #aa0000;">üóëÔ∏è Limpar Tudo</button>
            </div>
        </div>
    </div>
    </div>

    <script>
        const API_URL = 'https://api.jsonbin.io/v3/b/698ca2ffae596e708f22e412';

        const ADMIN_PASS = 'hunters2024';
        let currentFilter = 'all';
        let currentRecruitFilter = 'all';

        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            if (tab === 'messages') {
                document.querySelectorAll('.tab')[0].classList.add('active');
                document.getElementById('messagesTab').classList.add('active');
            } else if (tab === 'recruits') {
                document.querySelectorAll('.tab')[1].classList.add('active');
                document.getElementById('recruitsTab').classList.add('active');
                loadRecruits();
            } else if (tab === 'settings') {
                document.querySelectorAll('.tab')[2].classList.add('active');
                document.getElementById('settingsTab').classList.add('active');
            }
        }

        function filterMessages(filter) {
            currentFilter = filter;
            document.querySelectorAll('#messagesTab .filter-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            loadMessages();
        }

        function filterRecruits(filter) {
            currentRecruitFilter = filter;
            document.querySelectorAll('#recruitsTab .filter-btn').forEach(b => b.classList.remove('active'));
            event.target.classList.add('active');
            loadRecruits();
        }

        function login() {
            const pass = document.getElementById('adminPass').value;
            if (pass === ADMIN_PASS) {
                document.getElementById('loginPanel').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                loadMessages();
                setInterval(loadMessages, 3000);
            } else {
                alert('‚ùå Senha incorreta!');
            }
        }

        document.getElementById('adminPass').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') login();
        });

        async function loadMessages() {
            let messages = await getFromCloud('messages');
            
            if (currentFilter === 'pending') {
                messages = messages.filter(m => m.status === 'pending');
            } else if (currentFilter === 'answered') {
                messages = messages.filter(m => m.status === 'answered');
            }
            
            const allMessages = await getFromCloud('messages');
            const pending = allMessages.filter(m => m.status === 'pending').length;
            const answered = allMessages.filter(m => m.status === 'answered').length;

            document.getElementById('totalMsg').textContent = allMessages.length;
            document.getElementById('pendingMsg').textContent = pending;

            const list = document.getElementById('messagesList');
            list.innerHTML = '';

            if (messages.length === 0) {
                list.innerHTML = '<div style="text-align: center; padding: 40px; color: #ff6666;">Nenhuma mensagem neste filtro.</div>';
                return;
            }

            messages.reverse().forEach(msg => {
                const card = document.createElement('div');
                card.className = 'message-card';
                card.innerHTML = `
                    <div class="message-header">
                        <div>
                            <strong style="color: #ff0000; font-size: 1.2em;">${msg.name}</strong><br>
                            <small style="color: #ffcccc;">${msg.email}</small>
                        </div>
                        <div style="text-align: right;">
                            <div class="${msg.status === 'pending' ? 'status-pending' : 'status-answered'}">
                                ${msg.status === 'pending' ? '‚è≥ Pendente' : '‚úÖ Respondida'}
                            </div>
                            <small style="color: #ff6666;">${msg.date}</small>
                        </div>
                    </div>
                    <div style="background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                        <strong style="color: #ffcccc;">Mensagem:</strong><br>
                        ${msg.msg}
                    </div>
                    ${msg.response ? `
                        <div style="background: rgba(0,255,0,0.1); padding: 15px; border-radius: 8px; border-left: 3px solid #00ff00; margin-bottom: 10px;">
                            <strong style="color: #00ff00;">Sua Resposta:</strong><br>
                            ${msg.response}
                        </div>
                    ` : `
                        <textarea id="response-${msg.id}" placeholder="Digite sua resposta..."></textarea>
                        <button class="btn-small" onclick="sendResponse(${msg.id})">üì§ Enviar Resposta</button>
                    `}
                    <button class="btn-small" onclick="deleteMessage(${msg.id})" style="background: #8b0000; margin-left: 10px;">üóëÔ∏è Excluir</button>
                `;
                list.appendChild(card);
            });
        }

        async function loadRecruits() {
            let recruits = await getFromCloud('recruits');
            
            if (currentRecruitFilter === 'approved') {
                recruits = recruits.filter(r => r.status === 'approved');
            } else if (currentRecruitFilter === 'rejected') {
                recruits = recruits.filter(r => r.status === 'rejected');
            }
            
            const allRecruits = await getFromCloud('recruits');
            const approved = allRecruits.filter(r => r.status === 'approved').length;
            
            document.getElementById('totalRecruits').textContent = allRecruits.length;
            document.getElementById('approvedRecruits').textContent = approved;

            const list = document.getElementById('recruitsList');
            list.innerHTML = '';

            if (recruits.length === 0) {
                list.innerHTML = '<div style="text-align: center; padding: 40px; color: #ff6666;">Nenhuma inscri√ß√£o neste filtro.</div>';
                return;
            }

            recruits.reverse().forEach(rec => {
                const card = document.createElement('div');
                card.className = 'recruit-card';
                card.innerHTML = `
                    <div class="message-header">
                        <div>
                            <strong style="color: #00ff00; font-size: 1.3em;">üéÆ ${rec.nick}</strong><br>
                            <small style="color: #ccffcc;">${rec.discord}</small>
                        </div>
                        <div style="text-align: right;">
                            <div style="color: ${rec.status === 'approved' ? '#00ff00' : rec.status === 'rejected' ? '#ff0000' : '#ffcc00'};">
                                ${rec.status === 'approved' ? '‚úÖ Aprovado' : rec.status === 'rejected' ? '‚ùå Rejeitado' : '‚è≥ Pendente'}
                            </div>
                            <small style="color: #ccffcc;">${rec.date}</small>
                        </div>
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 15px 0;">
                        <div style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 5px;">
                            <strong>üî∫ Level:</strong> ${rec.level}
                        </div>
                        <div style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 5px;">
                            <strong>üí∞ Bounty:</strong> ${rec.bounty}
                        </div>
                        <div style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 5px;">
                            <strong>üéÇ Idade:</strong> ${rec.age} anos
                        </div>
                        <div style="background: rgba(0,0,0,0.3); padding: 10px; border-radius: 5px;">
                            <strong>ü§ñ IA:</strong> ${rec.aiAge} anos
                        </div>
                    </div>
                    ${rec.notes ? `<div style="background: rgba(255,255,0,0.1); padding: 10px; border-radius: 5px; margin: 10px 0;">
                        <strong>üìù Notas:</strong> ${rec.notes}
                    </div>` : ''}
                    <div class="action-buttons">
                        ${rec.status !== 'approved' ? `<button class="btn-small" onclick="approveRecruit(${rec.id})" style="background: #00aa00;">‚úÖ Aprovar</button>` : ''}
                        ${rec.status !== 'rejected' ? `<button class="btn-small" onclick="rejectRecruit(${rec.id})" style="background: #aa0000;">‚ùå Rejeitar</button>` : ''}
                        <button class="btn-small" onclick="addNotes(${rec.id})" style="background: #0066cc;">üìù Adicionar Nota</button>
                        <button class="btn-small" onclick="deleteRecruit(${rec.id})" style="background: #8b0000;">üóëÔ∏è Excluir</button>
                    </div>
                `;
                list.appendChild(card);
            });
        }

        async function sendResponse(id) {
            const response = document.getElementById('response-' + id).value;
            if (!response) {
                alert('‚ùå Digite uma resposta!');
                return;
            }
            const messages = await getFromCloud('messages');
            const msg = messages.find(m => m.id === id);
            if (msg) {
                msg.response = response;
                msg.status = 'answered';
                await updateCloud('messages', messages);
                alert('‚úÖ Resposta enviada!');
                loadMessages();
            }
        }

        async function deleteMessage(id) {
            if (!confirm('‚ùå Tem certeza que deseja excluir esta mensagem?')) return;
            let messages = await getFromCloud('messages');
            messages = messages.filter(m => m.id !== id);
            await updateCloud('messages', messages);
            alert('‚úÖ Mensagem exclu√≠da!');
            loadMessages();
        }

        async function approveRecruit(id) {
            const recruits = await getFromCloud('recruits');
            const rec = recruits.find(r => r.id === id);
            if (rec) {
                rec.status = 'approved';
                await updateCloud('recruits', recruits);
                alert('‚úÖ Inscri√ß√£o aprovada!');
                loadRecruits();
            }
        }

        async function rejectRecruit(id) {
            const recruits = await getFromCloud('recruits');
            const rec = recruits.find(r => r.id === id);
            if (rec) {
                rec.status = 'rejected';
                await updateCloud('recruits', recruits);
                alert('‚ùå Inscri√ß√£o rejeitada!');
                loadRecruits();
            }
        }

        async function addNotes(id) {
            const note = prompt('üìù Digite uma nota sobre este candidato:');
            if (note) {
                const recruits = await getFromCloud('recruits');
                const rec = recruits.find(r => r.id === id);
                if (rec) {
                    rec.notes = note;
                    await updateCloud('recruits', recruits);
                    alert('‚úÖ Nota adicionada!');
                    loadRecruits();
                }
            }
        }

        async function deleteRecruit(id) {
            if (!confirm('‚ùå Tem certeza que deseja excluir esta inscri√ß√£o?')) return;
            let recruits = await getFromCloud('recruits');
            recruits = recruits.filter(r => r.id !== id);
            await updateCloud('recruits', recruits);
            alert('‚úÖ Inscri√ß√£o exclu√≠da!');
            loadRecruits();
        }

        function saveSettings() {
            const settings = {
                maxAge: document.getElementById('maxAge').value,
                minLevel: document.getElementById('minLevel').value,
                minBounty: document.getElementById('minBounty').value
            };
            localStorage.setItem('huntersBR_settings', JSON.stringify(settings));
            alert('‚úÖ Configura√ß√µes salvas!');
        }

        function exportData() {
            const data = {
                messages: JSON.parse(localStorage.getItem('huntersBR_messages') || '[]'),
                recruits: JSON.parse(localStorage.getItem('huntersBR_recruits') || '[]'),
                settings: JSON.parse(localStorage.getItem('huntersBR_settings') || '{}')
            };
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'hunters-br-backup-' + new Date().toISOString().split('T')[0] + '.json';
            a.click();
            alert('‚úÖ Dados exportados!');
        }

        function clearAllData() {
            if (!confirm('‚ö†Ô∏è TEM CERTEZA? Isso vai apagar TODOS os dados!')) {
                return;
            }
            if (!confirm('‚ö†Ô∏è √öltima chance! Realmente deseja apagar tudo?')) {
                return;
            }
            localStorage.removeItem('huntersBR_messages');
            localStorage.removeItem('huntersBR_recruits');
            alert('‚úÖ Todos os dados foram apagados!');
            loadMessages();
            loadRecruits();
        }
    </script>
</body>
</html>
